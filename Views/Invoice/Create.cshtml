@using VaccinationManager.Models
@model VaccinationManager.Models.Invoice
@{
    ViewBag.Title = "Invoice Criteria";

    ViewBag.CurrentPage = "Invoice";

    Session["DefaultDate"] = DateTime.Now.ToString("dd/MM/yyyy");
}

@*<script type="text/javascript" src="/scripts/jquery-2.1.3.min.js"></script>
<script type="text/javascript" src="/scripts/moment.min.js"></script>
<script type="text/javascript" src="/scripts/bootstrap.min.js"></script>
<script type="text/javascript" src="/scripts/bootstrap-datetimepicker.js"></script>*@
<script src="~/Scripts/jquery-2.1.3.js"></script>
<script src="~/Scripts/bootstrap-datepicker.js"></script>
<link href="~/Content/bootstrap-datepicker.css" rel="stylesheet" />

<style type="text/css">
    
    .InvalidDateError {
        color: Red;
    }
</style>

<script type="text/javascript">
    $(document).ready(function() {

        
        //$("#errorLabel").css("visibility", "hidden");
        
        //var date = $("#VaccinationDate").val();
        //var date_regex = /^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-.\/])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$/;
        //alert(date_regex.test(date) + date);
        //    if (!(date_regex.test(date))) {
        //        $("#errorLabel").css("visibility", "visible");
                
               
        //    }

        //    $("#submitBtn").submit(function (e) {
        //        alert("sdnnfvindinsdjvindsv");
        //    e.preventDefault();
        //    var date = $("#VaccinationDate").val();
        //    var date_regex = /^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-.\/])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$/;
        //    alert(date_regex.test(date));
        //    if (!(date_regex.test(date))) {
        //        $("#errorLabel").css("visibility", "visible");
        //        alert("dgdf");
        //        e.preventDefault();
        //    }

        //});
    });

    

</script>

<h2 style="background-color: #e57c58; color: white; display: table; width: calc(100%); height: 50px; border-bottom: 3px solid #eee; padding-left: 20px;">Select Invoice Criteria</h2>
<div style="background-color: #e57c58; width: calc(100%); height: 5px;"></div>
<br />
<div class="container-fluid">
    @using (Html.BeginForm("Create", "Invoice",FormMethod.Post, htmlAttributes: new {@id = "CreateInvoice"}))
    {


        <div class="form-horizontal">
            <h4>Select Vaccination Date (e.g.01/01/2001)</h4>
            <hr/>
            @if (Session["DateError"] != null)
            { 
                if (Session["DateError"].ToString() != "")
                {
                        @Html.Label("Invalid Date Entered", htmlAttributes: new { @class = "InvalidDateError", id="errorLabel" })
                        <hr />
                }


             }
            else
            {
                <script type="text/javascript">
                    document.getElementById("errorLabel").remove();
                </script>
            }
            @*@Html.Label("Invalid Date Entered", htmlAttributes: new { @class = "InvalidDateError", id = "errorLabel" , visible = ""})*@
          
            @Html.Label("Vaccination Date", htmlAttributes: new { @class = "control-label col-md-2" })
            @Html.TextBox("VaccinationDate", @Session["DefaultDate"], new {@class = "form-control", placeholder = "DD/MM/YYYY", id = "VaccinationDate"})

            
            <hr/>

            <br/><br/><br/>
            @*<h4>Extended Fee Selection</h4>

            <table class="table">
                <tr>
                    <th>
                        @Html.Hidden("Fee Name")
                    </th>
                    <th>
                        @Html.DisplayName("Fee Name")
                    </th>
                    <th>
                        @Html.DisplayName("Description")
                    </th>
                    <th>
                        @Html.DisplayName("Amount")
                    </th>
                    <th>
                        @Html.DisplayName("Include?")
                    </th>
                    <th></th>
                </tr>
                
                @for (int i = 0; i < Model.ExtendedFeeList.Count; i++)
                {
                    <tr>
                        <td>
                            @Html.HiddenFor(item => Model.ExtendedFeeList[i].FeeId)
                        </td>
                        <td>
                            @Html.DisplayFor(item => Model.ExtendedFeeList[i].FeeName)
                        </td>
                        <td>
                            @Html.DisplayFor(item => Model.ExtendedFeeList[i].FeeDescription)
                        </td>
                        <td>
                            @Html.DisplayFor(item => Model.ExtendedFeeList[i].Amount)
                        </td>
                        <td>
                            @Html.DropDownListFor(item => Model.ExtendedFeeList[i].IsChecked, new List<SelectListItem>() {new SelectListItem() {Value = "Include", Text = "Include"}, new SelectListItem() {Value = "Exclude", Text = "Exclude", Selected = true}})
                        </td>
                    </tr>
                }

            </table>*@

            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" id="submitBtn" value="Generate Invoice" class="btn btn-default"/>
                </div>
            </div>
        </div>
    }

</div>

